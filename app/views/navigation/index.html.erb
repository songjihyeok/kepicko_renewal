
<section class="navi show">
  <h1 class="logo"><img src="/images/logo.png" alt="HYUNDAI KEFICO" /></h1>
  <!-- <div class="nav-header">
    <h2>MCU</h2>
    <ol class="location">
      <li><span>완성차</span></li>
      <li><span>FCEV</span></li>
      <li><span>Battery&amp;Motor P</span></li>
      <li class="now"><span>MCU</span></li>
    </ol>
  </div> -->
  <ul class="nav-1st">
    <% @level1s.each do |level1|%>
      <li data-id= <%= level1.id %>><span><%= level1.title %></span></li>
    <% end %>
  </ul>
  <div class="nav-wrapper">
    <!-- 완성차 -->
    <section class="nav-content show">
      <h1 class="blind">완성차</h1>
      <div class="nav-2nd">
        <%= render "navigation/level2", level2s: @level2s%>
      </div>
      <div class="nav-3rd">
        <%= render "navigation/level45", level4s: @level4s, level3: @level3  %>
      </div>
    </section>

    <!-- 전동2륜차-->
  </div>

  <span class="bt-close">닫기</span>
</section>

<script>
$(function(){
  var $navi = $('.navi');
  var level1 = $('.nav-1st');
  var level1Cont = $('.nav-content');
  var level3 = $('.nav-2nd > ul > li span');
  //navi open
  //navi close
  $('.bt-close').click(function(){
    window.location.href = "<%= @current_route %>"
  });

  level1.find('li').each(function(){
    var $this = $(this);
      $this.click(function(){
        var index = $(this).index();
        level1.find('li').removeClass('active');
        $(this).addClass('active');
        var id = $this.data("id")
        console.log( id )
        $.ajax({
          url: `/navigation/${id}`, // 클라이언트가 요청을 보낼 서버의 URL 주소
          data: { level1_id : id },                // HTTP 요청과 함께 서버로 보낼 데이터
          type: "PATCH",                    // HTTP 요청 방식(GET, POST)
          dataType: "script"
        })
      });
  });

  $(".level3_components").click(function(){
    var level3_id = $(this).data('3id');
    var level1_id = $(this).data('1id');
    console.log("level3_id", level3_id, "level1_id", level1_id )
    $.ajax({
      url: `/navigation/<%= @level1_id %>`, // 클라이언트가 요청을 보낼 서버의 URL 주소
      data: { level3_id : level3_id, level1_id: level1_id },
      type: "PATCH",
      dataType: "script"
    })
  });

  // if ($(name).parents('.nav-content').hasClass('show')){
  //   $(name).parents('.nav-content').find('.nav-box').removeClass('show');
  //   $(name).addClass('show');
  //   $(name).parents('.nav-content').find('.go-menu span > b').html(location);
  //
  //   $(this).parents('.nav-2nd').find('li').removeClass('active');
  //   $(this).parent('li').addClass('active');
  // }


  $('.menu').each(function(){
    var more = $(this).find('.more');
    if (!$(this).find('.submenu').length){
      $(this).find('.more').hide();
    }
    more.click(function(){
      $(this).parents('.nav-box').find('.menu').removeClass('show');
      $(this).parents('.menu').addClass('show');
    });
  });
});









</script>
